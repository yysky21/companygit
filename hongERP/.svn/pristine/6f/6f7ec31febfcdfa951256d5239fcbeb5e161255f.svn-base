/**
 * Copyright © 2012-2025 云南红掌柜珠宝有限公司 版权所有
 * 文件名: productCheck.js
 *
 * @author yuanyun
 * @Date  2017/11/30
 * @version 1.00
 */
var finance = (function ($) {
    "use strict";

    // 保存凭证
    function saveVoucher(uri) {
        var $form = $("#form");
        if (!validator.checkAll($form)) {
            return;
        }

        var json = JSON.stringify($form.serializeJSON());
        json = json.substring(0, (json.indexOf("details")-2))+json.substring((json.indexOf("]")+1),json.length-1) + ',"details":[';

        var trs = $("#voucherList tbody tr");

        for (var i = 0; i < trs.length; i++) {
            var inputs = $(trs[i]).find(":input");
            json += JSON.stringify(inputs.not('[value=""]').serializeJSON()["details"][0]) + ",";
        }

        json = json.substring(0, json.length-1) + ']}';

        $form.sendData(uri, json);
    }


    return {
        saveVoucher: saveVoucher
    }

})(jQuery);
